!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=30)}([function(e,t,n){"use strict";n.d(t,"e",(function(){return r})),n.d(t,"f",(function(){return o})),n.d(t,"g",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return d})),n.d(t,"i",(function(){return l}));chrome.extension,chrome.storage;var r=chrome.storage.local,o=chrome.runtime,a=chrome.tabs,i=chrome.browserAction,c=chrome.cookies,u=chrome.webNavigation,s=chrome.contextMenus,d=chrome.i18n,l=chrome.windows;chrome.webRequest},function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(7),o=n(2);function a(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function c(e){a(i,r,o,c,u,"next",e)}function u(e){a(i,r,o,c,u,"throw",e)}c(void 0)}))}}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var t=r.a.getDomain();this.urlPrefix="".concat(t,"/api/v1/"),this.accountPrefix="".concat(r.a.getAccountDomain(),"/"),this.noPrepend=!1,this.responseType=void 0}var t,n,a;return t=e,(n=[{key:"setNoPrepend",value:function(e){return this.noPrepend=e,this}},{key:"setResponseType",value:function(e){return this.responseType=e,this}},{key:"ajaxWithoutData",value:function(e,t,n,r){var a=this;return new Promise(function(){var c=i(regeneratorRuntime.mark((function i(c,u){var s,d;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return(s=new XMLHttpRequest).onload=function(){r||"blob"===this.responseType?c(this.response):c(this.responseText)},s.onerror=function(e){u(e)},s.open(e,a.prependUrl(t,n,r)),i.next=6,Object(o.c)("znbcsr");case 6:if(d=i.sent){i.next=10;break}return u(),i.abrupt("return");case 10:r&&(s.responseType="blob",s.setRequestHeader("processData",!1),s.setRequestHeader("contentType",!1)),a.responseType&&(s.responseType=a.responseType),s.setRequestHeader("X-ZCSRF-TOKEN","znbrcsr="+d.znbcsr),s.send();case 14:case"end":return i.stop()}}),i)})));return function(e,t){return c.apply(this,arguments)}}())}},{key:"ajaxWithData",value:function(e,t,n){var r=this;return new Promise(function(){var a=i(regeneratorRuntime.mark((function a(i,c){var u,s;return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return(u=new XMLHttpRequest).onload=function(e){i(this.responseText)},u.onerror=function(e){c(e)},u.open(e,r.prependUrl(t)),a.next=6,Object(o.c)("znbcsr");case 6:if(s=a.sent){a.next=10;break}return c(),a.abrupt("return");case 10:u.setRequestHeader("X-ZCSRF-TOKEN","znbrcsr="+s.znbcsr),u.send(n);case 12:case"end":return a.stop()}}),a)})));return function(e,t){return a.apply(this,arguments)}}())}},{key:"prependUrl",value:function(e,t,n){return n||this.noPrepend?e:t?"".concat(this.accountPrefix).concat(e):"".concat(this.urlPrefix).concat(e)}}])&&c(t.prototype,n),a&&c(t,a),e}()},function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"g",(function(){return i})),n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return u})),n.d(t,"e",(function(){return s})),n.d(t,"f",(function(){return d}));var r=n(0);function o(e){return new Promise((function(t,n){try{r.a.get(e,(function(e){t(e)}))}catch(e){t(void 0)}}))}function a(e){return new Promise((function(t,n){try{r.e.get(e,(function(e){t(e)}))}catch(e){t(void 0)}}))}function i(e){return new Promise((function(t,n){try{r.e.set(e,(function(){t(!0)}))}catch(e){t(!1)}}))}function c(e){return new Promise((function(t,n){try{r.e.remove(e,(function(){t(!0)}))}catch(e){t(!1)}}))}function u(e){return new Promise((function(t,n){try{r.i.create(e,(function(e){t(e)}))}catch(e){t(void 0)}}))}function s(e){return new Promise((function(t,n){try{r.f.sendMessage(e,(function(e){t(e)}))}catch(e){t(void 0)}}))}function d(e,t){return new Promise((function(n,o){try{r.g.sendMessage(e,t,(function(e){n(e)}))}catch(e){n(void 0)}}))}},function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={SEND_ANALYTICS:1e3,SIGN_IN:1001,USER_WINDOW:1002,DOWNLOAD_BOOK_LIST:1003,INIT_WINDOW:1004,GET_TAB_ID:1005,GET_DOCUMENT:1006,INIT_READER_VIEW:1007,DISPLAY_READER_FRAME:1008,GET_STATUS:1009,CREATE_TAG:1010,SEARCH_TAG:1011,SEND_FEEDBACK:1012,SIGN_OUT:1013,GET_ALL_TAGS:1014,SEARCH_TAG_FROM_LIST:1015,FETCH_ANNOUNCEMENT:1016,SHOW_MEETING_NOTE:1017,SAVE_MEETING_NOTE:1018,SHOW_RECIPE_POPUP:1019,CLOSE_RECIPE_POPUP:1020,SHOW_PDF_POPUP:1021,RESET_TOOLBAR_ICON:1022,SHOW_TOAST:1023,HIDE_TOAST:1024,GET_LOGIN_STATUS:1025,APP_LOADING:1026,PARTIAL_CAPTURE:1027,GET_USER_IMAGE:1028,PART_PAGE_SCREENSHOT:1029,FOCUSED_PAGE_SCREENSHOT:1030,GET_NB_DOMAIN:1031,PARTIAL_ANNOTATION_FUNC:1032,TAKE_SCREENSHOT:1033,GET_CURRENT_TAB:1034,SAVE_POSITION:1035,FETCH_NOTEBOOK_IMAGE:1036,FLUSH_CACHED_CARD:1037,FULL_PAGE_SCREENSHOT:1038,OPEN_ANNOTATOR:1039,SHOW_LOADING_IFRAME:1040,HIDE_LOADING_IFRAME:1041,DOWNLOAD_FROM_URL:1042}},function(e,t,n){"use strict";function r(e,t){return function(e,t){var n=e.getDate(),r=e.getMonth(),a=r+1,i=e.getFullYear(),c=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][r],u=e.getHours(),s=e.getMinutes(),d=e.getSeconds(),l="AM";u>=12&&(l="PM");u>12&&(u-=12);switch(t){case"dd-MMM, yyyy":return o(n)+"-"+c+", "+i;case"YYYY-MM-DDTHH:mm:SS+0530":return i+"-"+o(a)+"-"+o(n)+"T"+o(u)+":"+o(s)+":"+o(d)+"+0530";case"YYYY-MM-DDTHH:mm:SS+0000":return i+"-"+o(a)+"-"+o(n)+"T"+o(u)+":"+o(s)+":"+o(d)+"+0000";case"dd/MM/YYYY":return o(n)+"/"+o(a)+"/"+i;case"HH:mm:SS":return o(u)+":"+o(s)+":"+o(d);case"HH:mm M, MMM dd, yyyy":return o(u)+":"+o(s)+" "+l+", "+c+" "+o(n)+", "+i;default:return n+" "+c+" "+i}}(new Date(e),t)}function o(e){return e<10?"0"+e:""+e}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},function(e,t,n){"use strict";n.d(t,"j",(function(){return d})),n.d(t,"e",(function(){return l})),n.d(t,"p",(function(){return f})),n.d(t,"u",(function(){return m})),n.d(t,"t",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"r",(function(){return v})),n.d(t,"q",(function(){return h})),n.d(t,"g",(function(){return y})),n.d(t,"s",(function(){return b})),n.d(t,"k",(function(){return w})),n.d(t,"m",(function(){return E})),n.d(t,"y",(function(){return x})),n.d(t,"f",(function(){return k})),n.d(t,"o",(function(){return T})),n.d(t,"w",(function(){return O})),n.d(t,"c",(function(){return S})),n.d(t,"h",(function(){return F})),n.d(t,"v",(function(){return _})),n.d(t,"x",(function(){return I})),n.d(t,"z",(function(){return R})),n.d(t,"a",(function(){return D})),n.d(t,"i",(function(){return C})),n.d(t,"d",(function(){return A})),n.d(t,"b",(function(){return N})),n.d(t,"n",(function(){return L}));var r=n(2),o=n(3),a=n(0),i=n(4),c=n(8);n(9);function u(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){u(a,r,o,i,c,"next",e)}function c(e){u(a,r,o,i,c,"throw",e)}i(void 0)}))}}function d(){var e,t,n=navigator.userAgent,r=(navigator.appName,""+parseFloat(navigator.appVersion)),o=parseInt(navigator.appVersion,10);-1!=(e=n.indexOf("Chrome"))?("Chrome",r=n.substring(e+7)):n.lastIndexOf(" ")+1<(e=n.lastIndexOf("/"))&&(r=n.substring(e+1)),-1!=(t=r.indexOf(";"))&&(r=r.substring(0,t)),-1!=(t=r.indexOf(" "))&&(r=r.substring(0,t)),o=parseInt(""+r,10),isNaN(o)&&(r=""+parseFloat(navigator.appVersion),o=parseInt(navigator.appVersion,10));var i={platformVersion:r,deviceName:navigator.userAgent,deviceType:"Web"},c=a.f.getManifest().version;return i.appVersion=c,i.appName="Chrome Extension - "+c,i.platformName="Chrome",i}function l(){return(new Date).getTime()}function f(){var e=navigator.language;return"zh"===e||"zh-CN"===e||"zh-TW"===e}function m(e,t){document.createElement(e).constructor===HTMLElement&&customElements.define(e,t)}function p(e){return new Promise((function(t,n){for(var r=[],o=0,a=0;a<e.length;a++){var i=new FileReader;i.onload=c,i.readAsDataURL(e[a])}function c(){r.push(this.result),++o===e.length&&t(r)}}))}function g(){return new Promise(function(){var e=s(regeneratorRuntime.mark((function e(t,n){var i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.c)("notebookList");case 2:(i=e.sent)&&i.length||a.f.sendMessage({action:o.a.DOWNLOAD_BOOK_LIST},(function(e){var n=[];e&&(e=JSON.parse(e))&&h(e.code)&&(n=e.notebooks),t(n)}));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function v(e){return new Promise((function(t,n){if(fileMap[e])t(!0);else{var r=document.createElement("script");document.head.appendChild(r),r.onload=function(){fileMap[e]=!0,t(!0)},r.onerror=function(){n(!1)},r.src=e}}))}function h(e){return 200===e||201===e}function y(e){e&&(e.focus(),e.innerText&&b(e))}function b(e){var t,n;document.createRange?((t=document.createRange()).selectNodeContents(e),t.collapse(!1),(n=window.getSelection()).removeAllRanges(),n.addRange(t)):document.selection&&((t=document.body.createTextRange()).moveToElementText(e),t.collapse(!1),t.select())}function w(){var e,t,n,r,o=new Date;return o.getFullYear()+"-"+Object(i.b)(o.getMonth()+1)+"-"+Object(i.b)(o.getDate())+"T"+(Object(i.b)(o.getHours())+":"+Object(i.b)(o.getMinutes())+":"+Object(i.b)(o.getSeconds()))+(e=o.getTimezoneOffset()/60,t=e<0?"+":"-",n=Math.floor(Math.abs(e)),r=Math.floor(60*Math.abs(e)%60),t+Object(i.b)(n)+""+Object(i.b)(r))}function E(){return new Promise(function(){var e=s(regeneratorRuntime.mark((function e(t,n){var o,a,i,c;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.c)("userprofile");case 2:o=e.sent,a=void 0,o&&(a=o.userprofile)&&a.default_notecard_color&&"random"!==a.default_notecard_color.toLowerCase()&&t(a.default_notecard_color),c=(i=["#FFB47A","#FFEE8A","#FFC96C","#FFFFFF","#FF9575","#FF8785","#E9FF9D","#B3FFE8","#83D2FF","#CDC2FF","#F9D3FF","#D9E8F0"]).length,0,t(i[Math.floor(Math.random()*(c-0)+0)]);case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function x(e){if(-1!==e.indexOf("rgb")){var t=(e=e.substring(e.indexOf("(")+1,e.indexOf(")"))).split(",");return"#"+(16777216+(t[2]|t[1]<<8|t[0]<<16)).toString(16).slice(1)}return e}function k(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],r=atob(t[1]),o=r.length,a=new Uint8Array(o);o--;)a[o]=r.charCodeAt(o);return new Blob([a],{type:n})}function T(e,t){for(var n=0;n<e.length;n++){var r=e[n];r.is_read=!1;for(var o=0;o<t.length;o++){var a=t[o];if(a.announcement_id===r.announcement_id){r.is_read=a.is_read;break}}}return e}function O(e,t,n){return e?(e=(e=(e=(e=e.replace(/<article/g,"<div").replace(/<\/article>/g,"</div>")).replace(/<main/g,"<div").replace(/<\/main>/g,"</div>")).replace(/<section/g,"<div").replace(/<\/section>/g,"</div>")).replace(/<br>/g,"<br/>").replace(/<hr>/g,"<hr/>"),"true"===t&&function(e){e=Object(c.a)(e)}(e),e=(e=e.replace(/[\u2028\u2029]/gim,"<br />")).replace(/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/gim,""),"true"===n&&(e=e.replace(/"/g,"\\'")),e):e}function S(){return new Promise(function(){var e=s(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(r.d)("znbcsr");case 2:t(!0);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function F(e){if(e&&e.length){for(var t=document.createDocumentFragment(),n=0;n<e.length;n++){var r=document.createElement("div");r.id=e[n].notebook_id,r.classList.add("each-book"),r.innerText=e[n].name,t.appendChild(r)}return t}}function _(e,t){for(var n=(new DOMParser).parseFromString(e,"text/html"),r=n.querySelectorAll("script"),o=0;o<r.length;o++)r[o].parentElement.removeChild(r[o]);for(var a=n.querySelectorAll("iframe"),i=0;i<a.length;i++)a[i].parentElement.removeChild(a[i]);for(var c=n.querySelectorAll("style"),u=0;u<c.length;u++)c[u].parentElement.removeChild(c[u]);for(var s=n.querySelectorAll("button"),d=0;d<s.length;d++)s[d].parentElement.removeChild(s[d]);for(var l=n.querySelectorAll("input"),f=0;f<l.length;f++)l[f].parentElement.removeChild(l[f]);for(var m=n.querySelectorAll("textarea"),p=0;p<m.length;p++)m[p].parentElement.removeChild(m[p]);for(var g=n.querySelectorAll(".clipper-space"),v=0;v<g.length;v++){var h=document.createElement("div");h.innerHTML=g[v].innerHTML,g[v].parentElement.appendChild(h),g[v].parentElement.removeChild(g[v])}if(!t){for(var y=n.querySelectorAll("image-view"),b=0;b<y.length;b++)y[b].parentElement.removeChild(y[b]);for(var w=n.querySelectorAll("p"),E=0;E<w.length;E++)w[E].innerText&&w[E].innerText.trim()||w[E].querySelector("img")||w[E].parentElement.removeChild(w[E]);for(var x=n.querySelectorAll("br"),k=0;k<x.length;k++)x[k].innerText&&x[k].innerText.trim()||x[k].querySelector("img")||x[k].parentElement.removeChild(x[k]);for(var T=n.querySelectorAll("div"),O=0;O<T.length;O++)T[O].innerText&&T[O].innerText.trim()||T[O].querySelector("img")||T[O].parentElement.removeChild(T[O])}return n.body.innerHTML}function I(e){for(var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("image-view"),r=0;r<n.length;r++){var o=document.createTextNode("-()-");n[r].parentElement.replaceChild(o,n[r])}return"undefined"===t.body.innerHTML?"":t.body.innerHTML}function R(e,t){return new Promise(function(){var n=s(regeneratorRuntime.mark((function n(o,a){var i,c,u,s;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(r.c)("analyticsShown");case 2:for(i=n.sent,u=!0,i&&i.analyticsShown?c=i.analyticsShown:(c="[]",u=!0),c=JSON.parse(c),s=0;s<c.length;s++)c[s].zuid===t&&(c[s].shown=e,u=!1);return u&&c.push({shown:e,zuid:t}),n.next=10,Object(r.g)({analyticsShown:JSON.stringify(c)});case 10:o(!0);case 11:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}function D(e){return new Promise(function(){var t=s(regeneratorRuntime.mark((function t(n,o){var a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.c)("analyticsShown");case 2:a=t.sent,i=a&&a.analyticsShown?a.analyticsShown:"[]",i=JSON.parse(i),c=0;case 6:if(!(c<i.length)){t.next=13;break}if(i[c].zuid!==e){t.next=10;break}return n(!1),t.abrupt("return");case 10:c++,t.next=6;break;case 13:n(!0);case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}function C(e){return new Promise(function(){var t=s(regeneratorRuntime.mark((function t(n,o){var a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(r.c)("analyticsShown");case 2:a=t.sent,i=a&&a.analyticsShown?a.analyticsShown:"[]",i=JSON.parse(i),c=0;case 6:if(!(c<i.length)){t.next=13;break}if(i[c].zuid!==e){t.next=10;break}return n(i[c].shown),t.abrupt("return");case 10:c++,t.next=6;break;case 13:n(!1);case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}function A(e){return new Promise((function(t,n){var r=e.querySelectorAll("img");if(r&&r.length)for(var i=function(e){var n=r[e].src;if(!n)return"continue";a.f.sendMessage({action:o.a.DOWNLOAD_FROM_URL,data:{url:n}},(function(n){var o=document.createElement("image-view");o.setAttribute("image-data",n),o.setAttribute("dont_load_annotator",!0),o.id="image-view_"+l();var a=document.createElement("div"),i=document.createElement("div");i.innerHTML="<div class='clipper-space'><br></div>",a.appendChild(i),a.appendChild(o);var c=document.createElement("div");c.innerHTML="<div class='clipper-space'><br></div>",a.appendChild(c);var u=r[e].parentElement;u.removeChild(r[e]),u.appendChild(a),t(!0)}))},c=0;c<r.length;c++)i(c)}))}function N(e){for(var t=(new DOMParser).parseFromString(e,"text/html"),n=t.querySelectorAll("img"),r=0;r<n.length;r++)if(n[r].src&&-1===n[r].src.indexOf("http"))if(-1!==n[r].src.indexOf("moz-extension://")||-1!==n[r].src.indexOf("chrome-extension://")){var o=new URL(n[r].src);n[r].src=currentTab.url+o.pathname}else n[r].src=currentTab.url+n[r].src;return t.body.innerHTML}function L(e){if(!e||!e.trim())return"#212121";var t,n,r;if(e.match(/#/))t=function(e){return e=M(e),parseInt(e.substring(0,2),16)}(e),n=function(e){return e=M(e),parseInt(e.substring(2,4),16)}(e),r=function(e){return e=M(e),parseInt(e.substring(4,6),16)}(e);else{var o=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/);t=o[0],n=o[1],r=o[2]}return Math.round((299*parseInt(t)+587*parseInt(n)+114*parseInt(r))/1e3)>125?"#212121":"#FFFFFF"}function M(e){return"#"===e.charAt(0)?e.substring(1,7):e}},,function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",(function(){return o}));var o=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setup="https://notebook.zoho",this.accountsSetup="https://accounts.zoho",this.topLevelDomain=".com"}var t,n,o;return t=e,(n=[{key:"setSetup",value:function(e){return this.setup=e,this}},{key:"setTopLevelDomain",value:function(e){return this.topLevelDomain=e,this}},{key:"getTopLevelDomain",value:function(){return this.topLevelDomain}},{key:"getAccountsSetup",value:function(){return this.accountsSetup}},{key:"getSetup",value:function(){return this.setup}},{key:"getDomain",value:function(){return this.setup+""+this.topLevelDomain}},{key:"getAccountDomain",value:function(){return this.accountsSetup+""+this.topLevelDomain}}])&&r(t.prototype,n),o&&r(t,o),e}())},function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r={elements:["a","b","br","caption","cite","code","col","colgroup","dd","dl","dt","em","h1","h2","h3","h4","h5","h6","i","img","li","ol","p","q","small","strike","strong","sub","sup","table","tbody","td","tfoot","th","thead","tr","u","ul","div","span","figure","article","section"],attributes:{a:["href"],img:["type","height","src","width","duration","class","remotesrc","org-width","org-height","consumers","local-id"],col:["span","width"],colgroup:["span","width"],ol:["start","type"],q:["cite"],table:["summary","width"],td:["abbr","axis","colspan","rowspan","width"],th:["abbr","axis","colspan","rowspan","scope","width"],ul:["type"]},protocols:{a:{href:["http","https","mailto","tel"]},img:{src:["http","https","zresource"]}}};function o(e){for(var t=e.getElementsByTagName("style"),n=0;n<t.length;n++)t[n].parentNode.removeChild(t[n]);return e}function a(e){var t=document.createElement("div");t.innerHTML=e,t=o(t);var n=new Sanitize(r).clean_node(t),a=document.createElement("div");a.appendChild(n.cloneNode(!0));var i=a.innerHTML;return i=(i=i.replace(/[\u2028\u2029]/gim,"<br />")).replace(/[\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/gim,"")}},function(e,t,n){"use strict";n.d(t,"e",(function(){return s})),n.d(t,"k",(function(){return d})),n.d(t,"j",(function(){return l})),n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"o",(function(){return p})),n.d(t,"l",(function(){return g})),n.d(t,"c",(function(){return v})),n.d(t,"n",(function(){return h})),n.d(t,"q",(function(){return y})),n.d(t,"r",(function(){return b})),n.d(t,"p",(function(){return w})),n.d(t,"g",(function(){return E})),n.d(t,"m",(function(){return x})),n.d(t,"h",(function(){return k})),n.d(t,"i",(function(){return S})),n.d(t,"d",(function(){return F})),n.d(t,"f",(function(){return _}));var r=n(1),o=n(5),a=n(7),i=n(2);function c(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function u(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){c(a,r,o,i,u,"next",e)}function u(e){c(a,r,o,i,u,"throw",e)}i(void 0)}))}}function s(){return(new r.a).ajaxWithoutData("GET","notebooks?sort_column=-Notebook.LastModifiedTime&offset=0&limit=100")}function d(){return new Promise(function(){var e=u(regeneratorRuntime.mark((function e(t,n){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new r.a,e.next=3,o.ajaxWithoutData("GET","userprofile/accounts/status");case 3:a=e.sent,t(a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function l(){return new Promise(function(){var e=u(regeneratorRuntime.mark((function e(t,n){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new r.a,e.next=3,o.ajaxWithoutData("GET","userprofile");case 3:a=e.sent,t(a);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function f(e){return new Promise(function(){var t=u(regeneratorRuntime.mark((function t(n,o){var a,i,c,u,s,d;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("note/file"!==e.type){t.next=10;break}return t.next=3,T(e.fileUrl);case 3:return a=t.sent,t.next=6,O(e.notebook_id,a,"");case 6:i=t.sent,n(i),t.next=19;break;case 10:return c=new r.a,(u=new FormData).append("attachment",e.znml),s="notebooks/".concat(e.notebook_id,"/notecards"),e.notebook_id&&"undefined"!==e.notebook_id||(s="notecards"),t.next=17,c.ajaxWithData("POST",s,u);case 17:d=t.sent,n(d);case 19:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}function m(e,t,n,a){return new Promise(function(){var i=u(regeneratorRuntime.mark((function i(c,u){var s,d,l,f,m;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return s=new r.a,d=Object(o.f)(n),(l=new FormData).append("attachment",d,a),f="notebooks/".concat(e,"/notecards/").concat(t,"/resources"),i.next=7,s.ajaxWithData("POST",f,l);case 7:m=i.sent,c(m);case 9:case"end":return i.stop()}}),i)})));return function(e,t){return i.apply(this,arguments)}}())}function p(e,t,n){return new Promise(function(){var o=u(regeneratorRuntime.mark((function o(a,i){var c,u,s,d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=new r.a,(u=new FormData).append("JSONString",JSON.stringify({reminders:[{type:"reminder/time",reminder_time:n,created_time:(new Date).getTime()}]})),s="notebooks/".concat(e,"/notecards/").concat(t,"/reminders"),o.next=6,c.ajaxWithData("POST",s,u);case 6:d=o.sent,a(d);case 8:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}())}function g(e){return new Promise(function(){var t=u(regeneratorRuntime.mark((function t(n,o){var a,i,c;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new r.a,i="tags/search?query=".concat(e,"&limit=5"),t.next=4,a.ajaxWithData("GET",i);case 4:c=t.sent,n(c);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}function v(e,t){return new Promise(function(){var n=u(regeneratorRuntime.mark((function n(o,a){var i,c,u;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=new r.a,"tags",(c=new FormData).append("JSONString",JSON.stringify({name:e,created_time:(new Date).getTime(),resource_id:t})),n.next=6,i.ajaxWithData("POST","tags",c);case 6:u=n.sent,o(u);case 8:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())}function h(e){var t=e.sender,n=e.content,a=e.base64,i=e.imageName;return new Promise(function(){var e=u(regeneratorRuntime.mark((function e(c,u){var s,d,l,f;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=new r.a,"feedback",d=new FormData,a&&(l=Object(o.f)(a),d.append("attachment",l,i)),"Notebook - Chrome Extension Feedback",d.append("JSONString",JSON.stringify({subject:"Notebook - Chrome Extension Feedback",sender:t,content:n})),e.next=8,s.ajaxWithData("POST","feedback",d);case 8:f=e.sent,c(f);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function y(){return new Promise(function(){var e=u(regeneratorRuntime.mark((function e(t,n){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new r.a,"logout",e.next=4,o.ajaxWithoutData("GET","logout",!0);case 4:a=e.sent,t(a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function b(e,t,n){return new Promise(function(){var o=u(regeneratorRuntime.mark((function o(a,i){var c,u,s,d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=new r.a,u="notebooks/".concat(e,"/notecards/").concat(t),(s=new FormData).append("attachment",n),o.next=6,c.ajaxWithData("PUT",u,s);case 6:d=o.sent,a(d);case 8:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}())}function w(e,t,n){return new Promise(function(){var o=u(regeneratorRuntime.mark((function o(a,i){var c,u,s,d,l,f;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:for(c=[],u=0;u<n.length;u++)c.push(n[u].tag_id);return s=new r.a,d="notebooks/".concat(e,"/notecards/").concat(t,"/tags"),(l=new FormData).append("JSONString",JSON.stringify({tag_ids:c})),o.next=8,s.ajaxWithData("PUT",d,l);case 8:f=o.sent,a(f);case 10:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}())}function E(){return new Promise(function(){var e=u(regeneratorRuntime.mark((function e(t,n){var o,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=new r.a,"tags?offset=0&limit=1000",e.next=4,o.ajaxWithData("GET","tags?offset=0&limit=1000");case 4:a=e.sent,t(a);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function x(e,t){return new Promise((function(n,r){var o=[];t=t.toLowerCase(),e.map((function(e){e.name.toLowerCase().startsWith(t)&&o.push(e)})),n(JSON.stringify({code:200,tags:o}))}))}function k(){return new Promise(function(){var e=u(regeneratorRuntime.mark((function e(t,n){var r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"chromeClipper",(r=new XMLHttpRequest).onload=function(){t(this.responseText)},r.onerror=function(e){n(e)},r.open("GET","https://notebook.zoho.com/api/v1/announcements?last_announcement_time=1&platform=chromeClipper"),e.next=7,Object(i.c)("znbcsr");case 7:if(o=e.sent){e.next=11;break}return n(),e.abrupt("return");case 11:r.setRequestHeader("X-ZCSRF-TOKEN","znbrcsr="+o.znbcsr),r.send();case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function T(e){return new Promise(function(){var t=u(regeneratorRuntime.mark((function t(n,o){var a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=new r.a,t.next=3,a.ajaxWithoutData("GET",e,!1,!0);case 3:i=t.sent,n(i);case 5:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}function O(e,t,n){return new Promise(function(){var o=u(regeneratorRuntime.mark((function o(a,i){var c,u,s,d;return regeneratorRuntime.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:return c=new r.a,u=new FormData,s={name:"Untitled.pdf",notecard_name:"Untitled"},e&&"undefined"!==e&&(s.notebook_id=e),u.append("attachment",t,n||"Untitled.pdf"),u.append("JSONString",JSON.stringify(s)),"cards/file",o.next=9,c.ajaxWithData("POST","cards/file",u);case 9:d=o.sent,a(d);case 11:case"end":return o.stop()}}),o)})));return function(e,t){return o.apply(this,arguments)}}())}function S(){return new Promise(function(){var e=u(regeneratorRuntime.mark((function e(t,n){var o,c,u,s,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new r.a).setNoPrepend(!0),o.setResponseType("blob"),c=a.a.getTopLevelDomain(),e.next=6,Object(i.c)("userprofile");case 6:if((u=e.sent)&&u.userprofile){e.next=10;break}return t(void 0),e.abrupt("return");case 10:return s="https://contacts.zoho".concat(c,"/file?t=user&ID=").concat(u.userprofile.zuid,"&fs=thumb"),e.next=13,o.ajaxWithoutData("GET",s);case 13:d=e.sent,t(d);case 15:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())}function F(e){return new Promise(function(){var t=u(regeneratorRuntime.mark((function t(n,o){var a,i;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(a=new r.a).setResponseType("blob"),t.next=4,a.ajaxWithoutData("GET","covers/".concat(e,"/thumbnail?size=m"));case 4:i=t.sent,n(i);case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}function _(e){return new Promise(function(){var t=u(regeneratorRuntime.mark((function t(n,o){var c,u,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(c=new r.a).setNoPrepend(!0),c.setResponseType("blob"),a.a.getTopLevelDomain(),t.next=6,Object(i.c)("userprofile");case 6:if((u=t.sent)&&u.userprofile){t.next=10;break}return n(void 0),t.abrupt("return");case 10:return t.next=12,c.ajaxWithoutData("GET",e);case 12:s=t.sent,n(s);case 14:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}())}},function(e,t,n){"use strict";function r(){var e=["#FFFFFF","#FFEF8A","#FFC96C","#FFB47A","#FF9575","#FF8785","#E9FF9D","#B3FFE8","#83D2FF","#CDC2FF","#F9D3FF","#D9E8F0"];return e[Math.floor(Math.random()*e.length)]}function o(e,t,n){return"#"+(16777216+(n|t<<8|e<<16)).toString(16).slice(1)}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o}))},,,,,,,,,,,,,,,,,,,,function(e,t,n){"use strict";n.r(t);var r=n(5),o=n(0),a=n(3),i=n(2),c=n(10);function u(e,t,n,r,o,a,i){try{var c=e[a](i),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function s(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){u(a,r,o,i,c,"next",e)}function c(e){u(a,r,o,i,c,"throw",e)}i(void 0)}))}}var d=void 0,l=void 0,f=void 0,m=[],p="#FFFFFF",g="",v="";function h(){return(h=s(regeneratorRuntime.mark((function e(){var t,n,r,o;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.c)("readerFontFamily");case 2:(t=e.sent)&&t.readerFontFamily||(t={readerFontFamily:"serif"}),(n=document.querySelector(".font-checked"))&&n.parentElement.removeChild(n),(r=document.getElementById(t.readerFontFamily))&&r.appendChild(w()),(o=document.getElementById("reader-view-wrap"))&&(o.className=t.readerFontFamily);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function y(){return(y=s(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.c)("readerNightMode");case 2:(t=e.sent)&&t.readerNightMode&&((n=document.getElementById("nightModeCheckbox"))&&(n.checked=!0),document.body.classList.add("night-mode"));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function b(){return(b=s(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.c)("readerFontSize");case 2:if(t=e.sent){e.next=5;break}return e.abrupt("return");case 5:(n=document.getElementById("reader-view-wrap"))&&(n.style.fontSize=t.readerFontSize+"px"),(r=document.getElementById("fontRange"))&&(r.value=10*(t.readerFontSize-18));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(){var e=document.createElement("div");return e.classList.add("font-checked"),e}parent.postMessage({action:"getReaderViewData"},"*"),function(){document.onkeydown=function(e){if(27===e.keyCode){if("block"===document.getElementById("reader-view-overlay").style.display){var t=document.querySelector("choose-reminder");if(t){var n=document.getElementById("book-list-wrap");n&&n.removeChild(t)}else S(),O()}else parent.postMessage({action:"closeReaderView"},"*");e.stopPropagation()}};var e=document.getElementById("reader-close");e&&(e.onclick=function(e){parent.postMessage({action:"closeReaderView"},"*")});var t=document.getElementById("fontFamilyContainer");t&&(t.onclick=function(e){if(-1!==["serif","sansSerif"].indexOf(e.target.id)){var t=document.getElementById("reader-view-wrap");if(t){t.className=e.target.id;var n=document.querySelector(".font-checked");n&&n.parentElement.removeChild(n),e.target.appendChild(w()),Object(i.g)({readerFontFamily:e.target.id}),o.f.sendMessage({action:a.a.SEND_ANALYTICS,data:{category:"READER_VIEW",action:"FONT_FAMILY_CHANGE",label:e.target.id}})}}});var n=document.getElementById("reader-view-font"),u=document.getElementById("readerViewSettingsContainer"),E=document.getElementById("font-drop");n&&u&&(n.onclick=function(){n.classList.contains("highlight")?(n.classList.remove("highlight"),u.classList.remove("open"),E.classList.remove("open"),O()):(n.classList.add("highlight"),u.classList.add("open"),E.classList.add("open"),T())});var L=document.getElementById("fontRange");L&&(L.oninput=function(){var e,t,n;e=L.value,t=Math.round(e/10),(n=document.getElementById("reader-view-wrap"))&&(n.style.fontSize=18+t+"px"),Object(i.g)({readerFontSize:18+t}),o.f.sendMessage({action:a.a.SEND_ANALYTICS,data:{category:"READER_VIEW",action:"FONT_SIZE_CHANGE",label:18+t}})});var P=document.getElementById("nightModeCheckbox");P&&P.addEventListener("click",(function(e){var t=e.target.checked,n=void 0;t?(document.body.classList.add("night-mode"),n="NIGHT_MODE_ENABLE"):(document.body.classList.remove("night-mode"),n="NIGHT_MODE_DISABLE"),Object(i.g)({readerNightMode:t}),o.f.sendMessage({action:a.a.SEND_ANALYTICS,data:{category:"READER_VIEW",action:n}});var r=document.getElementById("reader-view-wrap"),c=document.getElementById("reader-data");r&&c&&(document.body.classList.contains("night-mode")?(r.style.backgroundColor="initial",c.style.backgroundColor="rgb(51, 51, 51)",c.style.color="#FFFFFF"):(r.style.backgroundColor="initial",c.style.backgroundColor="#FFFFFF",c.style.color="initial"))}));var B=document.getElementById("reader-save");B&&(B.onclick=function(){_(),k(),T();var e=document.getElementById("reader-book-list");e&&(e.innerHTML="",e.style.display="none"),o.f.sendMessage({action:a.a.DOWNLOAD_BOOK_LIST},function(){var e=s(regeneratorRuntime.mark((function e(t){var n,o,c,u,s,d,l,f,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t&&(t=JSON.parse(t))&&Object(r.q)(t.code)&&(n=t.notebooks),o=R(n),(c=document.getElementById("reader-book-list"))&&(c.appendChild(o),x()),c.style.display="block",u=0;case 7:if(!(u<n.length)){e.next=23;break}return s=n[u].cover_image_id,d=n[u].notebook_id,e.next=12,Object(i.e)({action:a.a.FETCH_NOTEBOOK_IMAGE,data:{cover_id:s}});case 12:if(l=e.sent,f=document.getElementById(d)){e.next=16;break}return e.abrupt("return");case 16:if(m=f.querySelector(".each-book-image")){e.next=19;break}return e.abrupt("return");case 19:m.style.backgroundImage="url(".concat(l,")");case 20:u++,e.next=7;break;case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),document.getElementById("reader-book-list").onclick=function(e){var t=e.target;if(t.classList.contains("each-book")||t.classList.contains("each-book-image")||t.classList.contains("each-book-name")){for(var n=document.querySelectorAll(".each-book"),r=0;r<n.length;r++){n[r].classList.remove("selected");var o=n[r].querySelector(".book-checked");o&&n[r].removeChild(o)}t.classList.contains("each-book")?(t.classList.add("selected"),t.appendChild(D())):(t.parentElement.classList.add("selected"),t.parentElement.appendChild(D()))}};var j=document.getElementById("reader-view-overlay");j&&(j.onclick=function(){var e=document.querySelector("choose-reminder");if(e){var t=document.getElementById("book-list-wrap");t&&t.removeChild(e)}else S(),O()}),window.addEventListener("changeNotecardColor",(function(e){var t=e.detail;if(t&&t.cardColor){var n=document.getElementById("reader-view-wrap"),r=document.getElementById("reader-data"),o=document.getElementById("edit-footer");if(n&&r){n.style.backgroundColor=t.cardColor,r.style.backgroundColor=t.cardColor,r.style.color="#000000",o.style.backgroundColor=t.cardColor;var a=t.cardColor,i=a.substring(4,a.length-1).replace(/ /g,"").split(",");p=Object(c.b)(i[0],i[1],i[2])}}N()})),window.addEventListener("removeTag",(function(e){var t=e.detail;if(t&&t.tag_id){for(var n=0;n<m.length;n++)if(m[n].tag_id===t.tag_id){m.splice(n,1);break}d.postMessage({tab_id:l,unsaved_textcard:{tags:m}})}})),window.addEventListener("addTag",(function(e){var t=e.detail;t&&t.tag_id&&(m.push({tagName:t.tagName,tag_id:t.tag_id}),d.postMessage({tab_id:l,unsaved_textcard:{tags:m}}))}));var H=document.getElementById("book-list-cancel");H&&(H.onclick=function(){F()});var q=document.getElementById("book-list-save");q&&(q.onclick=function(){document.body.classList.remove("edit-mode");var e=document.getElementById("reader-content");if(e){var t=document.getElementById("reader-title");t||(t="Untitled");var n=document.querySelector(".each-book.selected");d.postMessage({tab_id:l,unsaved_textcard:{notebook_id:n.id,title:t.innerText,color:p,content:e.innerHTML},save:!0}),o.f.sendMessage({action:a.a.SEND_ANALYTICS,data:{category:"READER_VIEW",action:"SAVE"}}),I("Adding Note",!0),F(),O(),parent.postMessage({action:"closeReaderView"},"*")}});var G=document.getElementById("tag-overlay");G&&(G.onclick=function(){Object(r.g)(document.getElementById("tag-editor"))});var W=document.getElementById("reminder");W&&(W.onclick=function(){var e=document.querySelector("choose-reminder");if(e){e=document.querySelector("choose-reminder");var t=document.getElementById("book-list-wrap");t&&t.removeChild(e)}else{(e=document.createElement("choose-reminder")).setAttribute("reminder",f);var n=document.getElementById("book-list-wrap");if(n){n.append(e);var r=document.getElementById("reminder-overlay");r&&(r.style.display="block")}}}),window.addEventListener("setReminder",(function(e){var t=e.detail;if(t&&t.reminder_time){var n=document.getElementById("reminder");n&&n.classList.add("highlight"),d.postMessage({tab_id:l,unsaved_textcard:{reminder_time:t.reminder_time}}),f=t.reminder_time}else f=void 0,function(){var e=document.getElementById("reminder");e&&e.classList.remove("highlight")}();var r=document.querySelector("choose-reminder");if(r){var o=document.getElementById("book-list-wrap");o&&o.removeChild(r)}}));var z=document.getElementById("reader-edit");z&&(z.onclick=function(){document.body.classList.add("edit-mode"),function(){var e=document.getElementById("reader-title"),t=document.getElementById("reader-content");e&&e.setAttribute("contenteditable",!0),t&&t.setAttribute("contenteditable",!0);var n=document.getElementById("edit-footer");n&&(document.body.classList.contains("night-mode")?n.style.backgroundColor="rgb(51, 51, 51)":n.style.backgroundColor="#FFFFFF")}()});var U=document.getElementById("reader-edit-cancel");U&&(U.onclick=function(){document.body.classList.remove("edit-mode"),C(),A(),function(){var e=document.getElementById("reader-content"),t=document.getElementById("reader-title");e&&(e.innerHTML=g),t&&(t.innerText=v);var n=document.getElementById("reader-view-wrap"),r=document.getElementById("reader-data");if(n&&r){document.body.classList.contains("night-mode")?(n.style.backgroundColor="initial",r.style.backgroundColor="rgb(51, 51, 51)",r.style.color="#FFFFFF"):(n.style.backgroundColor="initial",r.style.backgroundColor="#FFFFFF",r.style.color="initial");var o=document.getElementById("edit-footer");o&&(o.style.backgroundColor="#FFFFFF")}}()});var V=document.getElementById("reader-edit-save");V&&(V.onclick=function(){_(),k(),T(),A(),C();var e=document.getElementById("reader-book-list");e&&(e.innerHTML="",e.style.display="none"),o.f.sendMessage({action:a.a.DOWNLOAD_BOOK_LIST},function(){var e=s(regeneratorRuntime.mark((function e(t){var n,o,c,u,s,d,l,f,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=[],t&&(t=JSON.parse(t))&&Object(r.q)(t.code)&&(n=t.notebooks),o=R(n),(c=document.getElementById("reader-book-list"))&&(c.appendChild(o),x()),c.style.display="block",u=0;case 7:if(!(u<n.length)){e.next=23;break}return s=n[u].cover_image_id,d=n[u].notebook_id,e.next=12,Object(i.e)({action:a.a.FETCH_NOTEBOOK_IMAGE,data:{cover_id:s}});case 12:if(l=e.sent,f=document.getElementById(d)){e.next=16;break}return e.abrupt("return");case 16:if(m=f.querySelector(".each-book-image")){e.next=19;break}return e.abrupt("return");case 19:m.style.backgroundImage="url(".concat(l,")");case 20:u++,e.next=7;break;case 23:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())});var J=document.getElementById("color-picker");J&&(J.onclick=function(){N()});var Y=document.getElementById("reader-title");Y&&(Y.onfocus=function(){Y.style.textOverflow="clip"},Y.onfocusout=function(){Y.style.textOverflow="ellipsis"},Y.onkeydown=function(e){13===e.keyCode&&(e.preventDefault(),e.stopPropagation(),Object(r.g)(document.getElementById("reader-content")))}),Y&&(Y.onpaste=function(e){e.preventDefault(),e.stopPropagation();var t=void 0;if(window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),!t)return!0;M(t),Object(r.g)(Y)});var K=document.getElementById("reader-content");K&&(K.onpaste=function(e){e.preventDefault(),e.stopPropagation();var t=void 0;if(window.clipboardData&&window.clipboardData.getData?t=window.clipboardData.getData("Text"):e.clipboardData&&e.clipboardData.getData&&(t=e.clipboardData.getData("text/plain")),!t)return!0;M(t),Object(r.g)(K)}),function(){b.apply(this,arguments)}(),function(){y.apply(this,arguments)}(),function(){h.apply(this,arguments)}()}(),function(){L.apply(this,arguments)}();var E=window.addEventListener?"addEventListener":"attachEvent";function x(){var e=document.querySelector("dots-loading");e&&(e.style.display="none")}function k(){var e=document.querySelector("dots-loading");e&&(e.style.display="block")}function T(){var e=document.getElementById("reader-view-overlay");e&&(e.style.display="block")}function O(){var e=document.getElementById("reader-view-overlay");e&&(e.style.display="none")}function S(){var e=document.getElementById("reader-view-font");e&&e.classList.remove("highlight");var t=document.getElementById("readerViewSettingsContainer");t&&t.classList.remove("open"),document.getElementById("font-drop").classList.remove("open"),F()}function F(){var e=document.getElementById("book-list-wrap");if(e){e.style.display="none";var t=document.getElementById("reader-view-overlay");t&&t.classList.remove("shade")}}function _(){var e=document.getElementById("book-list-wrap");if(e){e.style.display="block";var t=document.getElementById("reader-view-overlay");t&&t.classList.add("shade")}}function I(e,t){var n=document.getElementById("nb-save-text");n&&(n.innerText=e);var r=document.getElementById("reader-edit");r&&(r.style.right=t?"164px":"116px")}function R(e){if(e&&e.length){for(var t=document.createDocumentFragment(),n=0;n<e.length;n++){var r=document.createElement("div");r.id=e[n].notebook_id,r.classList.add("each-book");var o=document.createElement("div");o.classList.add("each-book-image");var a=document.createElement("div");a.classList.add("each-book-name"),a.innerText=e[n].name,r.appendChild(o),r.appendChild(a),0===n&&(r.classList.add("selected"),r.appendChild(D())),t.appendChild(r)}return t}}function D(){var e=document.createElement("div");return e.classList.add("book-checked"),e}function C(){var e=document.getElementById("reader-title"),t=document.getElementById("reader-content");e&&e.setAttribute("contenteditable",!1),t&&t.setAttribute("contenteditable",!1)}function A(){var e=document.querySelector("nb-color-picker");e&&e.parentElement.removeChild(e)}function N(){var e=document.querySelector("nb-color-picker");if(e)e.parentElement.removeChild(e);else{(e=document.createElement("nb-color-picker")).setAttribute("no-overlay",!0),e.setAttribute("css-style","\n            left: 0;\n            right: 0;\n            width: 149px;\n            height: 122px;\n            margin : auto;\n            z-index: 2;\n        ");var t=document.getElementById("reader-data");t&&t.appendChild(e)}}function L(){return(L=s(regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(i.c)("znbcsr");case 2:(t=e.sent)&&t.znbcsr||((n=document.getElementById("reader-save"))&&(n.style.display="none"),(r=document.getElementById("reader-edit"))&&(r.style.display="none"));case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(e){var t,n;window.getSelection?(t=window.getSelection()).rangeCount&&((n=t.getRangeAt(0)).deleteContents(),n.insertNode(document.createTextNode(e))):document.selection&&document.selection.createRange&&((n=document.selection.createRange()).text=e)}(0,window[E])("attachEvent"===E?"onmessage":"message",(function(e){var t=e.data;if(t)switch(t.action){case"getReaderViewDataResponse":var n=t.readerViewData;if(!n)return;var i=document.getElementById("reader-title");i&&(i.innerText=n.title,v=n.title);var c=document.getElementById("reader-content");c&&(n.content=Object(r.w)(n.content,"true","false"),g=Object(r.v)(n.content),c.innerHTML=g),function(){var e=document.getElementById("reader-data");if(e){var t=e.querySelector("dots-loading");t&&e.removeChild(t)}}(),o.f.sendMessage({action:a.a.GET_CURRENT_TAB},(function(e){l=e.id,(d=o.f.connect({name:""+l})).onMessage.addListener((function(e){if(e)switch(e.action){case"cardCreated":I("Note Added",!0),setTimeout((function(){I("Save",!1)}),3e3)}}));var t=document.createElement("a");t.href=e.url,t.innerText=e.url,c.appendChild(t)}))}}))}]);